{% extends 'home/base.html' %} 
{% load static %} 

{% block title %}FocusUP - Painel{% endblock %} 

{% block content %} 
    <div class="painel-container">
        <main class="painel-principal">
            
            <section id="inicioID" class="secao destaque-gradiente">
                <h1 class="titulo_main">Bem-vindo, {{ user.nome_usuario|default:user.email }}!</h1>
                <p id="frase_motivation" class="frase_motivation">
                    Continue sua jornada e conquiste seus objetivos.
                </p>
            </section>

            <section id="tarefasID" class="secao">
                <h2>Suas Tarefas</h2>
                <p>Aqui vão aparecer as tarefas pendentes.</p>
                <a href="{% url 'home:lista_Tarefas' %}" class="botao-destaque">
                    Ver todas as tarefas
                </a>
            </section>

            <section id="evolucaoID" class="secao">
                <h2>Sua Evolução</h2>
                
                <div class="barra-progresso">
                    <small id="progresso-level-texto">Progresso Nível {{ user.nivel }}</small>
                    
                    <div class="xp-valores">
                        <span id="progresso-xp-atual">{{ xp_usuario|default:0 }} XP</span>
                        <span id="progresso-xp-necessario">{{ xp_necessario|default:100 }} XP</span>
                    </div>

                    <div class="barra-fundo">
                        {% widthratio xp_usuario xp_necessario 100 as progresso_percentual %}
                        <div class="barra-preenchimento" id="progresso-barra-preenchimento" style="width: {{ progresso_percentual }}%;">
                            {{ progresso_percentual }}%
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <aside class="painel-lateral">
            
            <div id="perfilID" class="secao bloco-usuario">
                <div class="usuario-stats">
                    <div class="stat-item">
                        <span class="stat-numero" id="xp-total-display">{{ user.xp_atual|default:0 }}</span>
                        <small class="stat-label">XP ATUAL</small>
                    </div>
                    <div class="stat-item"> 
                        <span class="stat-numero" id="dias-foco-display">{{ user.dias_foco }}</span> 
                        <small class="stat-label">DIAS DE FOCO</small>
                    </div>
                </div>
            </div>

            <div class="stat-item-foco-botao-wrapper">
                {% if pode_resgatar %}
                    <button class="botao-resgatar-foco" id="btn-resgatar-foco">
                        Resgatar Foco (20xp)
                    </button>
                {% else %}
                    <button class="botao-resgatar-foco" id="btn-resgatar-foco" disabled>
                        Foco resgatado!
                    </button>
                {% endif %}
            </div>

            <section id="amigosID" class="secao">
                <h2>Amigos</h2>
                <a href="{% url 'home:listar_amigos' %}" class="botao-secundario" style="margin-bottom: 0.75rem; display: block; text-align: center;">Ver Amigos</a>
                <a href="{% url 'home:buscar_usuarios' %}" class="botao-secundario" style="margin-bottom: 0.75rem; display: block; text-align: center;">Buscar Usuários</a>
                <a href="{% url 'home:listar_pedidos_amizade' %}" class="botao-secundario" style="display: block; text-align: center;">Pedidos Pendentes</a>
            </section>

        

            <section id="configID" class="secao">
                <h2>Configurações</h2>
                <p>Preferências da sua conta.</p>
                <a href="{% url 'home:editar_perfil' %}" class="botao-secundario">Ajustar Conta</a>
            </section>
        </aside>
    </div>
{% endblock content %}


{% block extra_scripts %}
    <script type="application/json" id="js-data">
{
    "resgatarFocoUrl": "{% url 'home:resgatar_foco' %}",
    "csrfToken": "{{ csrf_token }}"
}
</script>
    
{% endblock extra_scripts %}